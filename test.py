# 23.11.17: rev0
import unittest

from vento_util import direzione_dominante


class test_vento_util(unittest.TestCase):
    def test_direzione_dominante(self):
        dati_vento = [
            ('2016-01-01', 1.811, 162),
            ('2016-01-01', 2.608, 326),
            ('2016-01-01', 0.414, 267),
            ('2016-01-01', 0.331, 102),
            ('2016-01-01', 1.982, 2),
            ('2016-01-01', 1.381, 104),
            ('2016-01-01', 0.227, 54),
            ('2016-01-01', 1.562, 6),
            ('2016-01-01', 1.086, 289),
            ('2016-01-01', 0.687, 129),
            ('2016-01-01', 0.986, 238),
            ('2016-01-01', 0.018, 109),
            ('2016-01-01', 1.684, 137),
            ('2016-01-01', 0.895, 329),
            ('2016-01-01', 2.838, 333),
            ('2016-01-01', 2.616, 197),
            ('2016-01-01', 1.277, 161),
            ('2016-01-01', 1.565, 2),
            ('2016-01-01', 1.066, 195),
            ('2016-01-01', 0.123, 126),
            ('2016-01-02', 1.188, 175),
            ('2016-01-02', 2.722, 207),
            ('2016-01-02', 1.266, 119),
            ('2016-01-02', 2.100, 360),
            ('2016-01-02', 2.743, 204),
            ('2016-01-02', 2.018, 33),
            ('2016-01-02', 0.977, 230),
            ('2016-01-02', 2.444, 102),
            ('2016-01-02', 2.604, 139),
            ('2016-01-02', 1.841, 330),
            ('2016-01-02', 0.931, 141),
            ('2016-01-02', 1.813, 347),
            ('2016-01-02', 1.418, 61),
            ('2016-01-02', 2.306, 174),
            ('2016-01-02', 1.824, 10),
            ('2016-01-02', 0.033, 152),
            ('2016-01-02', 2.556, 186),
            ('2016-01-02', 1.288, 15),
            ('2016-01-02', 0.929, 309),
            ('2016-01-02', 0.300, 364),
            ('2016-01-03', 0.946, 270),
            ('2016-01-03', 2.661, 315),
            ('2016-01-03', 0.296, 99),
            ('2016-01-03', 2.865, 94),
            ('2016-01-03', 0.590, 279),
            ('2016-01-03', 0.579, 114),
            ('2016-01-03', 0.456, 176),
            ('2016-01-03', 2.886, 27),
            ('2016-01-03', 0.763, 362),
            ('2016-01-03', 2.692, 65),
            ('2016-01-03', 0.302, 150),
            ('2016-01-03', 1.353, 212),
            ('2016-01-03', 1.536, 152),
            ('2016-01-03', 2.473, 131),
            ('2016-01-03', 2.536, 235),
            ('2016-01-03', 1.748, 290),
            ('2016-01-03', 2.352, 261),
            ('2016-01-03', 1.623, 281),
            ('2016-01-03', 2.708, 93),
            ('2016-01-03', 0.652, 202),
        ]

        discretizzazione = 'giornaliero'
        risultato = [('N', '2016-01-01'), ('N', '2016-01-02'),('O', '2016-01-03')]

        result = direzione_dominante(dati_vento, discretizzazione)
        self.assertEqual(risultato, result)

if __name__ == '__main__':
    unittest.main()
